\vspace{2mm}
\ffigbox[\FBwidth]{%
\caption{\centering Représentation du problème \(PL_0\) dans \(\bb R^2\)}\label{fig:td1_ex04_f3}
}{
    \fbox{
        \begin{tikzpicture}
            \begin{axis}[
                axis lines=middle,
                xlabel={\(x_1\)},
                ylabel={\(x_2\)},
                xmin=0, xmax=5,
                ymin=0, ymax=6.5,
                grid=both,
                axis equal image,
                width=10cm,
                height=7cm,
                legend pos=outer north east,
                legend cell align=left,
                legend image post style={fill opacity=0.45},
                legend style={fill=pagebg, draw=pagetext}
            ]

            % ----- Constraint line: 2x1 + x2 = 6 -----
            \addplot[domain=0:3.2, very thick, color=blue] {6 - 2*x};
            \addlegendentry{\(2x_1 + x_2 = 6\)}

            % ----- Constraint line: 2x1 + 3x2 = 9 -----
            \addplot[domain=0:4.8, very thick, color=orange] {(9 - 2*x)/3};
            \addlegendentry{\(2x_1 + 3x_2 = 9\)}
            
            % ----- Separation lines x2 = 1 and x2 = 2 -----
            \addplot[dashed, thick, gray] coordinates {(0,1) (5,1)};
            \addlegendentry{\(x_2 = 1\)}

            \addplot[dashed, thick, gray] coordinates {(0,2) (5,2)};
            \addlegendentry{\(x_2 = 2\)}

            % ----- Feasible region divided into 2 now
            \addplot[
                fill=cyan!35,
                opacity=0.45,
                draw=none,
                area legend
            ] coordinates {
                (0,0)
                (0,1)
                (2.5,1)
                (3,0)
            };
            \addlegendentry{Région réalisable}
            \addplot[
                fill=cyan!35,
                opacity=0.45,
                draw=none,
                area legend,
                forget plot
            ] coordinates {
                (0,2)
                (0,3)
                (1.5,2)
            };

            % ----- Cancelled region: 1 < x2 < 2 inside feasible set -----
            \addplot[
                pattern=north east lines,
                pattern color=purple!70,
                draw=none,
                opacity=0.5,
                forget plot
            ] coordinates {
                (0,1)
                (0,2)
                (1.5,2)
                (2.25,1.5)
                (2.5,1)
            };

            \addlegendimage{
                area legend,
                fill=pagebg,
                draw=pagetext,
                postaction={
                    pattern=north east lines,
                    pattern color=purple!70
                }
            }
            \addlegendentry{Région exclue \(1 < x_2 < 2\)}


            % ----- Real optimum -----
            \addplot[only marks, mark=*, mark size=3pt, color=red!80!black]
            coordinates {(2.25,1.5)};
            \addlegendentry{Solution réelle \((2.25,1.5)\)}

            % ----- Integer optimum -----
            \addplot[only marks, mark=square*, mark size=3pt, color=purple]
            coordinates {(0,3)};
            \addlegendentry{Solution entière \((0,3)\)}

            % ----- Level line z = 12.75 -----
            \addplot[dashed, thick, yellow, domain=0:4.5]
            {-0.75*(x - 2.25) + 1.5};
            \addlegendentry{Ligne de niveau \(z = 12.75\)}

            \end{axis}


        \end{tikzpicture}
    }
}