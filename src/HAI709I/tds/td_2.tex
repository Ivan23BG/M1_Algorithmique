% ----- Consignes exo 1 ----- %
\begin{td-exo}[] % 1
	Dire si les fonctions suivantes sont:
	\begin{itemize}
		\item bornées par un polynôme:
		\begin{gather*}
			f_1(n) = n, \quad f_2(n) = n^3 - 4n^2 + 2n + 9, \quad f_3(n) = n \log_2(n), \\
			f_4(n) = {1.1}^n, \quad f_5(n) = 2^{\frac12n}, \quad f_6(n) = 2^{\sqrt{n}}, \quad
			f_7(n) = n^{\log_2(n)}
		\end{gather*}
		\item négligeables:
		\begin{gather*}
			g_1(n) = \frac{1}{n^2+n+1}, \quad g_2(n) = \frac{3}{\log_2(n)}, \quad g_3(n) = 2^{-n}, \\
			g_4(n) = 2^{-\frac12n}, \quad g_5(n) = \frac{n^2+n+1}{e^n}, \quad g_6(n) = 2^{-\sqrt{n}}, \quad
			g_7(n) = n^{-\log_2(n)}
		\end{gather*}
	\end{itemize}
\end{td-exo}

% ----- Solutions exo 1 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\ %
		\begin{itemize}
			\item On a
			\begin{itemize}
				\item \(f_1 = n\) est bornée par \(n^2\),
				\item \(f_2 = n^3 - 4n^2 + 2n + 9\) est bornée par \(n^4\),
				\item \(f_3 = n \log_2(n)\) est bornée par \(n^2\),
				\item \(f_4 = {1.1}^n\) n'est pas bornée par un polynôme,
				\item \(f_5 = 2^{\frac12n}\) n'est pas bornée par un polynôme,
				\item \(f_6 = 2^{\sqrt{n}}\) n'est pas bornée par un polynôme,
				\item \(f_7 = n^{\log_2(n)}\) n'est pas bornée par un polynôme.
			\end{itemize}

			\item On a
			\begin{itemize}
				\item \(g_1(n) = \frac{1}{n^2+n+1}\) n'est pas négligeable,
				\item \(g_2(n) = \frac{3}{\log_2(n)}\) n'est pas négligeable,
				\item \(g_3(n) = 2^{-n}\) est négligeable par rapport à \(\frac1{n}\),
				\item \(g_4(n) = 2^{-\frac12n}\) est négligeable par rapport à \(\frac1{n}\),
				\item \(g_5(n) = \frac{n^2+n+1}{e^n}\) est négligeable par rapport à \(\frac1{n}\),
				\item \(g_6(n) = 2^{-\sqrt{n}}\) est négligeable par rapport à \(\frac1{n}\),
				\item \(g_7(n) = n^{-\log_2(n)}\) est négligeable par rapport à \(\frac1{n}\),
			\end{itemize}
		\end{itemize}
	\end{td-sol}
}{}


% ----- Consignes exo 2 ----- %
\begin{td-exo}[] % 2
	Considérons un chiffrement de Vigenère \(\pi\) où l’espace de messages est constitué de toutes les
	chaînes de 3 caractères et \(\gen\) fonctionne de la manière suivante: d’abord, une période \(t\) est
	tirée uniformément au hasard dans \({1,2, 3}\), puis une clé \(k\) est tirée uniformément au hasard dans
	\({0, . . . , 25}^t\).
	\begin{itemize}
		\item Définissez un adversaire \(\mathcal{A}\) tel que \(\bb P(\text{PrivK}^{eav}_{\mathcal{A}, \Pi} = 1) > \frac12\).
		\item Définissez un adversaire \(\mathcal{A}\) tel que \(\bb P(\text{PrivK}^{eav}_{\mathcal{A}, \Pi} = 1) \geq \frac34\).
	\end{itemize}
\end{td-exo}

% ----- Solutions exo 2 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\ %
		On a
		\begin{equation*}
			\begin{aligned}
				&\bb P(\text{PrivK}^{eav}_{\mathcal{A}, \Pi} = 1)\\
				=& \bb P(b' = b)\\
				=& \sum_{i=1}^3 \bb P(t=i) \cdot \bb P(b'=b\ \mid\ t=i)\\
				=& \frac13 \sum_{i=1}^3 \bb P(b'=b\ \mid\ t=i)
			\end{aligned}
		\end{equation*}
		\(\mathcal A\) recoit \(c_1,c_2,c_3\), choisit \(m_0= (0,0,0)\) et \(m_1=(0,1,2)\) et produit \(b'=0\). Si \(c_1=c_2\) ou \(c_2=c_3\), alors,
		pour \(t=1\):
		\begin{equation*}
			\begin{aligned}
				\bb P(b'=b \ \mid\ t=1)
				&= \bb P(b=0) \cdot \bb P(b'=0\ \mid\ t=1 \wedge b=0)\\
				&+ \bb P(b=1)\cdot \bb P(b'=1\ \mid\ t=1 \wedge b=1)\\
				&= \frac12\cdot1+\frac12\cdot1\\
				&=1,
			\end{aligned}
		\end{equation*}
		pour \(t=2\):
		\begin{equation*}
			\begin{aligned}
				\bb P(b'=b \ \mid\ t=2)
				&= \bb P(b=0) \cdot \bb P(b'=0\ \mid\ t=2 \wedge b=0)\\
				&+ \bb P(b=1)\cdot \bb P(b'=1\ \mid\ t=2 \wedge b=1)\\
				&= \frac12\cdot1+\frac12\cdot\left(1-\frac1{26}\right)\\
				&=\frac{51}{52},
			\end{aligned}
		\end{equation*}
		pour \(t=3\):
		\begin{equation*}
			\begin{aligned}
				\bb P(b'=b \ \mid\ t=3)
				&= \bb P(b=0) \cdot \bb P(b'=0\ \mid\ t=3 \wedge b=0)\\
				&+ \bb P(b=1)\cdot \bb P(b'=1\ \mid\ t=3 \wedge b=1)\\
				&= \frac12\cdot p + \frac12\cdot\left(1-p\right)\\
				&=\frac12.
			\end{aligned}
		\end{equation*}
		Ce qui donne
		\begin{equation*}
			\begin{aligned}
				\bb P(\text{PrivK}^{eav}_{\mathcal{A}, \Pi} = 1)
				&= \frac13 \sum_{i=1}^3 \bb P(b'=b\ \mid\ t=i)\\
				&= \frac13\cdot 1+\frac13\cdot\frac{51}{52}+\frac13\cdot\frac12\\
				% avec l'autre méthode, ca devient
				&= \frac13+\frac13+\frac13\cdot12=\frac56 > \frac34
			\end{aligned}
		\end{equation*}
		% si c1 = c3, on choisit b'=0, si c1 = c3-2, on choisit b'=1, sinon, au pif, disons b'=0 -> GO REFAIRE TOUS LES CALCULS :DDDDDDD
	\end{td-sol}
}{}


% ----- Consignes exo 3 ----- %
\begin{td-exo}[] % 3
	Soit \(G\) un PRG avec un facteur d’expansion \(l(n) > 2n\). Dans chacun des cas suivants, prouver que
	\(G'\) est aussi un PRG, si tel est le cas. Sinon, trouver un contre-exemple.
	\begin{itemize}
		\item Définissez \(G' \overset{\text{def}}= G(s_1,\ldots,s_{\lceil \frac n4\rceil})\),
		où \(s=s_1,\ldots s_n\).
		\item Définissez \(G' \overset{\text{def}}= G(s_1,\ldots,s_{\lceil \frac n2\rceil})\),
		où \(s=s_1,\ldots s_n\).
		\item Définissez \(G' \overset{\text{def}}= G(s\mid\mid0^{\n s})\).
	\end{itemize}
\end{td-exo}

% ----- Solutions exo 3 ----- %
\iftoggle{showsolutions}{
	
}{}


% ----- Consignes exo 4 ----- %
\begin{td-exo}[] % 4
	TO FILL
\end{td-exo}


% ----- Solutions exo 4 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\ %
		TO FILL
	\end{td-sol}
}{}


% ----- Consignes exo 5 ----- %
\begin{td-exo}[] % 5
	TO FILL
\end{td-exo}

% ----- Solutions exo 5 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\ %
		TO FILL
	\end{td-sol}
}{}
