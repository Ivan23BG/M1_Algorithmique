% ----- Consignes exo 1 ----- %
\begin{td-exo}[Flots --- 3pts]\,\\ % 1
    Calculer un flot maximal sur le réseau de transport ci-dessous, commençant par une augmentation de flot le long du chemin \(sadbep\).
    En expliquant comment l'obtenir, donner une coupe minimale du réseau.

    \input{../assets/tikz/exam_blanc_ex_1_1.tex}
\end{td-exo}

% ----- Solutions exo 1 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\,\\ % 1
		Commençons par retirer \(sadbep\) au réseau pour obtenir le réseau résiduel suivant:

        \input{../assets/tikz/exam_blanc_ex_1_2.tex}

        Ensuite, on peut faire passer 2 de flot par \(sbdp\) et 1 de flot par \(scfp\) pour obtenir les graphes suivants:

		\input{../assets/tikz/exam_blanc_ex_1_3.tex}

        Ensuite, on peut faire passer 1 de flot par \(sadp\) et 3 par \(sbep\):

        \input{../assets/tikz/exam_blanc_ex_1_4.tex}

        Il ne reste plus qu'à faire passer une dernière fois 1 de flot par \(sadbep\) et on aura fini:

        \input{../assets/tikz/exam_blanc_ex_1_5.tex}

        On a trouvé un flot maximal de valeur 10.
        Une coupe minimale est donnée par l'ensemble des sommets atteignables depuis \(s\) dans le réseau résiduel final, soit \(\{s, c\}\).

	\end{td-sol}
}{}


% ----- Consignes exo 2 ----- %
\begin{td-exo}[Indépendant dans les subcubiques --- 5pts]\,\\ % 2
    Un graphe \(G = (V,E)\) est dit \defemph{subcubique} si tous ses sommets ont degré au plus 3, c'est à dire si \(\forall v\in V, \mathsf{deg}_G(v) \leq 3\).
    Le but de l'exercice est de donner des bornes sur \(\alpha(G)\), la taille du plus grand ensemble indépendant (ou stable) de \(G\) en fonction de \(n\), le nombre de sommets de \(G\).
    \begin{enumerate}
        \item On commence par fournir une borne inférieure pour \(\alpha(G)\).
        \begin{enumerate}
            \item Montrer que si \(x\) est un sommet de \(G\) et \(I\) un indépendant de \(G \setminus \left( x\cup N_G(x) \right)\) alors \(I \cup \{x\}\) est un indépendant de \(G\).
            \item En déduire, par récurrence sur \(n\), que tout graphe subcubique à \(n\) sommets admet un indépendant de taille au moins \(\lceil \frac{n}{4} \rceil\).
        \end{enumerate}

        \item On suppose maintenant que \(G\) est cubique (c'est à dire \(\forall v\in V, \mathsf{deg}_G(v) = 3\)) et on va établir une borne supérieure pour \(\alpha(G)\).
        \begin{enumerate}
            \item Soit \(X\) un indépendant de \(G\). En fonction de la taille de \(X\), calculer le nombre d'arêtes, noté \(e(X, \ol{X})\), entre \(X\) et son complémentaire.
            \item En déduire que \(|X| \leq |\ol{X}|\) puis que \(|X| \leq \lfloor \frac{n}{2} \rfloor\).
        \end{enumerate}

        \item Donner deux exemples de graphes cubiques \(G_1\) et \(G_2\) sur \(n\) sommets tels que \(\alpha(G_1) = \frac{n}{4}\) et \(\alpha(G_2) = \frac{n}{2}\). Si possible, vous donnerez des exemples pour \(n\) arbitrairement grand.
    \end{enumerate}
\end{td-exo}

% ----- Solutions exo 2 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\, % 2
		\begin{enumerate}
            \item On fournit une borne inférieure pour \(\alpha(G)\).
            \begin{enumerate}
                \item\label{exb:ex2:q1} Soit \(x\) un sommet de \(G\) et \(I\) un indépendant de \(G \setminus \left( x\cup N_G(x) \right)\).
                Soit \(y\) un sommet de \(I\). 
                
                Si \(y\) est un voisin de \(x\) alors \(y \in N_G(x)\) ce qui contredit le fait que \(y\) est dans \(G \setminus \left( x\cup N_G(x) \right)\).
                Donc \(y\) n'est pas un voisin de \(x\). 
                
                Alors, tout sommet de \(I\) n'est pas voisin de \(x\) donc \(I \cup \{x\}\) est un indépendant de \(G\).

                \item On montre par récurrence (forte) sur \(n\) que tout graphe subcubique à \(n\) sommets admet un indépendant de taille au moins \(\lceil \frac{n}{4} \rceil\).
                
                Pour \(n=1\), le graphe subcubique est réduit à un sommet isolé qui est bien un indépendant de taille \(1 \geq \lceil \frac{1}{4} \rceil\).
                
                Supposons que la propriété est vraie pour tout graphe subcubique à \(k\) sommets (avec \(1 \leq k < n\)) et montrons-la pour un graphe subcubique \(G\) à \(n\) sommets.
                
                Soit \(G\) un graphe subcubique à \(n\) sommets.
                Soit \(x\) un sommet de \(G\).
                
                Le graphe \(G' = G \setminus \left( x\cup N_G(x) \right)\) est subcubique (car \(G\) l'est) et possède au moins \(n-4\) sommets (ceux de départ, moins \(x\) et au plus ses 3 voisins).
                Par hypothèse de récurrence, il admet un indépendant \(I\) de taille au moins \(\lceil \frac{n-4}{4} \rceil\).
                
                D'après~\eqref{exb:ex2:q1}, \(I \cup \{x\}\) est un indépendant de \(G\) de taille au moins \(\lceil \frac{n-4}{4} \rceil + 1\).
            \end{enumerate}
            Donc \(G\) admet un indépendant de taille au moins \(\lceil \frac{n}{4} \rceil\).

            \item On suppose maintenant que \(G\) est cubique et on établit une borne supérieure pour \(\alpha(G)\).
            \begin{enumerate}
                \item Soit \(X\) un indépendant de \(G\).
                Chaque sommet de \(X\) possède 3 arêtes qui le relient à des sommets de \(\ol{X}\) (car \(G\) est cubique et \(X\) est un indépendant).
                Donc \(e(X, \ol{X}) = 3|X|\).

                \item Au mieux, tout triplet de sommets de \(X\) est relié à un même triplet de sommets de \(\ol{X}\).
                Donc \(|X| \leq |\ol{X}|\).

                De plus, on a \(X \sqcup \ol{X} = V\) donc \(|X| + |\ol{X}| = n\). Comme \(|X| \leq |\ol{X}|\), on a forcément \(|X| \leq \lfloor \frac{n}{2} \rfloor\).
            \end{enumerate}

            \item On peut utiliser les graphes suivants:
            \begin{itemize}
                \item Pour \(G_1\), on peut prendre une collection de copies du graphe suivant (le nombre de copies dépend de \(n\)):
                
                \input{../assets/tikz/exam_blanc_ex_2_1.tex}

                Chaque copie possède un indépendant de taille 1 (par exemple le sommet central) et le graphe est cubique.
                Donc pour \(n\) suffisamment grand, on peut obtenir un graphe cubique à \(n\) sommets avec un indépendant de taille \(\frac{n}{4}\).

                \item Pour \(G_2\), on peut prendre une collection de copies du graphe suivant (le nombre de copies dépend de \(n\)):
                
                \vspace{0.2cm}
                \input{../assets/tikz/exam_blanc_ex_2_2.tex}

                Chaque copie possède un indépendant de taille 3 (par exemple les trois sommets en haut) et le graphe est cubique.
                Donc pour \(n\) suffisamment grand, on peut obtenir un graphe cubique à \(n\) sommets avec un indépendant de taille \(\frac{n}{2}\).
            \end{itemize}
        \end{enumerate}
	\end{td-sol}
}{}


% ----- Consignes exo 3 ----- %
\begin{td-exo}[Couplage max --- 3pts]\,\\ % 3
    Dans le graphe suivant, appliquer l'algorithme d'Edmonds pour calculer un couplage maximum, en sachant que le couplage \(\left\{ be, ci, hp \right\}\) a déjà été précalculé. Au cours de votre déroulement d'algorithme, vous devrez, à au moins une reprise, contracter un blossom.

    \vspace{0.2cm}
    \input{../assets/tikz/exam_blanc_ex_3_1.tex}
\end{td-exo}

% ----- Solutions exo 3 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\,\\ % 3   
        On commence par rajouter le couplage initial:

        \vspace{0.2cm}
        \input{../assets/tikz/exam_blanc_ex_3_2.tex}

        Contractons maintenant des blossoms. On peut commencer par le blossom \(cfi\):

        \vspace{0.2cm}
        \input{../assets/tikz/exam_blanc_ex_3_3.tex}

        Ensuite on peut contracter le blossom \(cfijq\):

        \vspace{0.2cm}
        \input{../assets/tikz/exam_blanc_ex_3_4.tex}

        Cherchons maintenant des chemins augmentants. 
        On part d'un sommet non saturé, ici \(a\), et on trouve le chemin augmentant \(ae-eb-bcfijq\).
        On augment alors le couplage:

        \vspace{0.2cm}
        \input{../assets/tikz/exam_blanc_ex_3_5.tex}

        Il ne reste qu'un seul sommet non saturé \(o\) donc on a fini de trouver des chemins augmentants.
        Il faut maintenant décontracter nos blossoms pour retrouver le couplage maximum:

        \vspace{0.2cm}
        \input{../assets/tikz/exam_blanc_ex_3_6.tex}

        Enfin, on décontracte le blossom \(cfi\) pour obtenir le couplage maximum final:
        
        \vspace{0.2cm}
        \input{../assets/tikz/exam_blanc_ex_3_7.tex}

        On voit alors notre couplage maximum de taille 5:
        \begin{equation*}
            \left\{
                ae, bi, cf, hp, qj
            \right\}.
        \end{equation*}
	\end{td-sol}
}{}


% ----- Consignes exo 4 ----- %
\begin{td-exo}[Miam! --- 5pts]\,\\ % 4
    Trois étudiants affamés, nommés \(E_1, E_2\) et \(E_3\), se retrouvent pour manger 6 pizzas, notées \(P_1, \ldots, P_6\).
    Chaque étudiant veut manger 2 pizzas exactement. Les étudiants ont les contraintes alimentaires suivantes:
    \begin{itemize}
        \item \(E_1\) qui déteste les champignons, ne veut manger que les pizzas \(P_1, P_4\) et \(P_5\).
        \item \(E_2\) qui est allergique au chorizo, ne veut manger que les pizzas \(P_2, P_5\) et \(P_6\).
        \item \(E_3\) qui ne digère pas les anchois, ne veut manger que les pizzas \(P_1, P_2, P_3\) et \(P_6\).
    \end{itemize}
    On souhaite savoir si il est possible de répartir les 6 pizzas afin de satisfaire les choix des étudiants.
    \begin{enumerate}
        \item Construire le graphe biparti \(H_{(E, P)}\) défini sur \(\left\{P_1, \ldots, P_6\right\} \cup \left\{E_1, E_2, E_3\right\}\) et dont les arêtes sont \(\{P_i E_j : \) si \(E_j\) veut manger la pizza \(P_i\}\).
        \item Quelle structure souhaite-t-on trouver dans \(H_{(E, P)}\) pour garantir une solution au problème?
        \item Une \defemph{copie} d'un sommet \(x\) dans un graphe \(G\) est un sommet \(y\) non-adjacent à \(x\) et dont le voisinage est identique à celui de \(x\). A partir du graphe \(H_{(E, P)}\), on construit le graphe \(H_{(E, P)}'\) en ajoutant une copie pour chaque sommet \(E_i\). Sans preuve, quelle structure souhaite-t-on trouver dans \(H_{(E, P)}'\) pour garantir que les trois étudiants peuvent se répartir les six pizzas en respectant leurs choix?
        \item Résoudre le problème (en utilisant un algorithme du cours \(\ldots\)).
        \item Plus généralement, soit \(k\geq 2\) fixé, le \defemph{centre} d'un graphe biparti complet \(K_{1, k}\) est le sommet de ce graphe qui n'est pas une feuille. 
        Etant donné un graphe biparti \(G = ((A, B), E)\), on souhaite déterminer si \(G\) peut être (sommet-)~partitionné en graphes \(K_{1, k}\) dont les centres sont tous dans \(A\). 
        Donner un algorithme de résolution en temps polynomial pour ce problème. Prouver la validité de votre algorithme.
    \end{enumerate}
\end{td-exo}

% ----- Solutions exo 4 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\, % 4
		\begin{enumerate}
            \item Le graphe biparti \(H_{(E, P)}\) est le suivant:

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_1.tex}

            \item On souhaite trouver deux couplages disjoints saturant les sommets \(E_1, E_2\) et \(E_3\).

            \item On souhaite trouver un couplage parfait dans le graphe \(H_{(E, P)}'\) suivant:

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_2.tex}

            \item On utilise l'algorithme d'Edmonds pour trouver un couplage maximum dans \(H_{(E, P)}'\).
            On commence par trouver un chemin augmentant à partir de \(E_1\):

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_3.tex}
            
            Dans la suite on omettra les arêtes à partir de sommets étudiants déjà dans le couplage.

            Puis on trouve un chemin augmentant à partir de \(E_1'\):

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_4.tex}

            Ensuite pour \(E_2\):

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_5.tex}

            Et pour \(E_2'\):

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_6.tex}

            Enfin pour \(E_3\):

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_7.tex}

            Et pour \(E_3'\):

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_4_8.tex}

            On a trouvé un couplage parfait dans \(H_{(E, P)}'\) donc les trois étudiants peuvent se répartir les six pizzas comme suit:
            \begin{equation*}
                \begin{cases}
                    E_1 \text{ mange } P_1 \text{ et } P_4\\
                    E_2 \text{ mange } P_2 \text{ et } P_5\\
                    E_3 \text{ mange } P_3 \text{ et } P_6
                \end{cases}
            \end{equation*}

            \item Pas encore rédigé.
        \end{enumerate}
	\end{td-sol}
}{}


% ----- Consignes exo 5 ----- %
\begin{td-exo}[Graphes auto-complémentaires --- 4pts]\,\\ % 5
    Un graphe \(G\) est dit \defemph{auto-complémentaire} si \(G\) est isomorphe à son complémentaire \(\ol{G}\).
    \begin{enumerate}
        \item Justifier que \(P_4\) et \(C_5\) sont auto-complémentaires.
        \item Montrer que tout graphe auto-complémentaire est connexe.
        \item En notant \(n\) le nombre de sommets de \(G\), calculer le nombre d'arêtes d'un graphe auto-complémentaire en fonction de \(n\).
        \item En déduire que \(n \equiv 0 \text{ ou } 1 \mod 4\).
        \item\label{exb:q5:1} Soit \(G\) un graphe auto-complémentaire et \(P\) un chemin de longueur 3 (c'est à dire avec 4 sommets).
        On note \(G'\) le graphe obtenu depuis \(G \cup P\) en reliant le premier et le dernier sommet de \(P\) à tous les sommets de \(G\).
        Montrer que \(G'\) est auto-complémentaire.
        \item En déduire que pour tout \(n\) avec \(n \equiv 0 \text{ ou } 1 \mod 4\), il existe un graphe auto-complémentaire à \(n\) sommets.
    \end{enumerate}
\end{td-exo}

% ----- Solutions exo 5 ----- %
\iftoggle{showsolutions}{
	\begin{td-sol}[]\, % 5
		\begin{enumerate}
            \item Dessinons ces graphes et leurs complémentaires pour comprendre visuellement ce qui se passe:

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_5_1.tex}

            Lorsqu'on prend leur complémentaire, on obtient les graphes suivants:

            \vspace{0.2cm}
            \input{../assets/tikz/exam_blanc_ex_5_2.tex}

            On voit alors clairement qu'on peut identifier dans ces graphes un unique chemin (respectivement cycle) qui passe par toutes les arêtes et tous les sommets.

            Formellement, on peut définir les fonctions suivantes:
            \begin{equation*}
                f_{P_4} : 
                \begin{cases}
                    P_1 \mapsto P_2\\
                    P_2 \mapsto P_4\\
                    P_3 \mapsto P_1\\
                    P_4 \mapsto P_3
                \end{cases}
                \quad
                f_{C_5} : 
                \begin{cases}
                    C_1 \mapsto C_1\\
                    C_2 \mapsto C_3\\
                    C_3 \mapsto C_5\\
                    C_4 \mapsto C_2\\
                    C_5 \mapsto C_4
                \end{cases}
            \end{equation*}
            qui sont des isomorphismes entre \(P_4\) et \(\ol{P_4}\) (respectivement \(C_5\) et \(\ol{C_5}\)).

            Alors, ces graphes sont bien auto-complémentaires.

            \item Soit \(G\) un graphe non connexe.
            Alors, il existe une partition de \(V(G)\) en deux ensembles non vides \(A\) et \(B\) tels qu'il n'existe pas d'arête entre un sommet de \(A\) et un sommet de \(B\).
            Dans le complémentaire \(\ol{G}\), tous les sommets de \(A\) sont reliés à tous les sommets de \(B\).
            Donc \(\ol{G}\) est connexe.
            Ainsi, \(G\) et \(\ol{G}\) ne peuvent pas être isomorphes (et donc auto-complémentaires).

            Donc tout graphe auto-complémentaire est connexe.

            \item Soit \(G\) un graphe auto-complémentaire à \(n\) sommets.
            On note \(m\) le nombre d'arêtes de \(G\).
            On remarque que le nombre total d'arêtes possibles dans un graphe à \(n\) sommets est \(\frac{n(n-1)}{2}\).
            Comme \(G\) est isomorphe à \(\ol{G}\), on a forcément 
            \begin{equation*}
                \begin{aligned}
                    m = \frac{n(n-1)}{2} - m
                    &\iff 2m = \frac{n(n-1)}{2}\\
                    &\iff m = \frac{n(n-1)}{4}.
                \end{aligned}
            \end{equation*}

            \item Comme \(m\) est un entier, \(\frac{n(n-1)}{4}\) doit être un entier et donc 
            on a forcément \(n(n-1) \equiv 0 \mod 4\), c'est à dire \(n \equiv 0 \text{ ou } 1 \mod 4\).

            \item On se donne un graphe auto-complémentaire \(G\) à \(n\) sommets et un chemin \(P\) de longueur 3.
            On note \(G'\) le graphe obtenu depuis \(G \cup P\) avec le procédé décrit dans l'énoncé~\eqref{exb:q5:1}.
            On a:

            % TODO: replace by the correct figure
            % \vspace{0.2cm}
            % \input{../assets/tikz/exam_blanc_ex_5_3.tex}

            Observons ce qui se passe quand on passe au complémentaire \(\ol{G'}\):

            % TODO: replace by the correct figure
            % \vspace{0.2cm}
            % \input{../assets/tikz/exam_blanc_ex_5_4.tex}

            

            \item Si \(n = 4\) ou \(n = 5\), on peut prendre \(G = P_4\) ou \(G = C_5\).
            Sinon, on peut construire \(G'\) à partir de \(G\) en répétant le procédé 
            décrit en~\eqref{exb:q5:1} pour obtenir un graphe de taille \(n\) (car l'opération 
            ajoute 4 sommets à chaque fois et conserve la propriété d'auto-complémentarité).
        \end{enumerate}
	\end{td-sol}
}{}
