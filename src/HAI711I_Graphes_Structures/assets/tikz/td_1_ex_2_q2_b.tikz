% Figure BFS 2
\ffigbox[\FBwidth]{
\caption{\centering \,\\BFS sur \(Q_3\) --- Étape 2}\label{Fig:bfs2}
}{
    \fbox{
        \begin{tikzpicture}[scale=1, every node/.style={circle, draw, fill=blue!20, inner sep=1pt, font=\scriptsize}]
            \def\L{2}
            \def\dx{0.9} 
            \def\dy{0.6}
            \def\offset{0.15}
            
            \coordinate (v000) at (0,0);
            \coordinate (v001) at (\L,0);
            \coordinate (v011) at (\L,\L);
            \coordinate (v010) at (0,\L);
            \coordinate (v100) at ($ (v000) + (\dx,\dy) $);
            \coordinate (v101) at ($ (v001) + (\dx,\dy) $);
            \coordinate (v111) at ($ (v011) + (\dx,\dy) $);
            \coordinate (v110) at ($ (v010) + (\dx,\dy) $);
            
            % Edges
            \foreach \a/\b in {v000/v001, v001/v011, v011/v010, v010/v000}
                \draw[gray!50] (\a) -- (\b);
            \foreach \a/\b in {v100/v101, v101/v111, v111/v110, v110/v100}
                \draw[gray!50] (\a) -- (\b);
            \foreach \a/\b in {v000/v100, v001/v101, v011/v111, v010/v110}
                \draw[gray!50] (\a) -- (\b);
            
            % Niveau 0 -> Niveau 1 (from previous)
            \draw[->, thick, red!40!black] 
                ($ (v000) + (0.1,-\offset) $) -- ($ (v001) + (-0.1,-\offset) $);
            \draw[->, thick, red!40!black] 
                ($ (v000) + (-\offset,0.1) $) -- ($ (v010) + (-\offset,-0.1) $);
            \draw[->, thick, red!40!black] 
                ($ (v000) + (0.05,0.05) $) -- ($ (v100) + (-0.05,-0.05) $);
            
            % Niveau 1 -> Niveau 2
            % 001 → 011
            \draw[->, very thick, red!70!black] 
                ($ (v001) + (\offset,0.1) $) -- ($ (v011) + (\offset,-0.1) $);
            \node[draw=none, fill=white, inner sep=1pt, font=\tiny, text=red!70!black] 
                at ($ (v001)!0.5!(v011) + (\offset+0.25,0) $) {4};
            
            % 001 → 101
            \draw[->, very thick, red!70!black] 
                ($ (v001) + (\offset,0) $) -- ($ (v101) + (\offset,0) $);
            \node[draw=none, fill=white, inner sep=1pt, font=\tiny, text=red!70!black] 
                at ($ (v001)!0.3!(v101) + (\offset+0.3,0) $) {5};
            
            % Nodes
            \node[fill=green!30] at (v000) {000};
            \node[fill=green!30] at (v001) {001};
            \node at (v011) {011};
            \node at (v010) {010};
            \node at (v100) {100};
            \node at (v101) {101};
            \node at (v111) {111};
            \node at (v110) {110};
        \end{tikzpicture}
    }
}